<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ArxivCaster — Daily Papers</title>
    <style>
      :root{
        --bg: #0a0b12;
        --fg: #f6f7fb;
        --muted:#9aa4c8;
        --card: rgba(255,255,255,0.06);
        --border: rgba(255,255,255,0.12);
        --accent1:#7aa6ff;
        --accent2:#b388ff;
      }
      *{box-sizing:border-box}
      html,body{height:100%;margin:0}
      body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial; color:var(--fg); background:var(--bg); overflow-x:hidden}
      .bg{
        position:fixed; inset:0; z-index:-2;
        background:
          radial-gradient(1200px 800px at 20% -10%, #223066 0%, transparent 60%),
          radial-gradient(900px 900px at 120% 0%, #3e2a7a 0%, transparent 60%),
          radial-gradient(800px 600px at 80% 110%, #0f3b5f 0%, transparent 55%),
          linear-gradient(180deg, #0a0b12 0%, #0a0b12 100%);
      }
      .glow{
        position:fixed; inset:-20vh -20vw; z-index:-1; filter: blur(60px) saturate(120%);
        background: conic-gradient(from 0deg, #6ea8ff, #b388ff, #6ea8ff);
        opacity:.3; animation: spin 40s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg) } }

      .container{max-width:1100px; margin:0 auto; padding:24px 20px 80px}
      nav{display:flex; align-items:center; justify-content:space-between; padding:8px 0}
      nav .brand{font-weight:700; letter-spacing:.2px}
      nav a{color:var(--fg); opacity:.8; text-decoration:none}
      nav a:hover{opacity:1}

      .hero{padding:48px 0 28px}
      .eyebrow{color:var(--muted); font-size:14px; letter-spacing:.12em; text-transform:uppercase}
      .title{font-size:48px; line-height:1.04; margin:8px 0 12px; font-weight:800; letter-spacing:-.02em;
        background: linear-gradient(90deg, var(--accent1), var(--accent2)); -webkit-background-clip:text; background-clip:text; color:transparent}
      .lead{font-size:18px; color:#d5dcfd; max-width:760px}
      .cta{margin-top:20px; display:flex; gap:12px}
      .btn{display:inline-flex; gap:8px; align-items:center; padding:12px 16px; border-radius:999px; text-decoration:none; color:#0a0b12; background:#f7f9ff; font-weight:600}
      .btn.secondary{background:transparent; color:#f7f9ff; border:1px solid var(--border)}

      .latest{margin:40px 0 8px; padding:18px; border-radius:16px; border:1px solid var(--border); background:var(--card); backdrop-filter: blur(8px)}
      .latest h3{margin:0 0 10px; font-size:18px}
      .latest .meta{color:var(--muted); font-size:13px; margin-bottom:8px}
      .latest .actions{display:flex; gap:10px; margin-top:10px}

      .section{margin:26px 0 8px; display:flex; align-items:baseline; justify-content:space-between}
      .section h2{margin:0; font-size:20px}
      .grid{display:grid; gap:16px; grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
      .card{display:block; background:var(--card); border:1px solid var(--border); border-radius:14px; padding:16px; text-decoration:none; color:inherit; transform: translateY(8px); opacity:0; transition: transform .4s ease, opacity .4s ease}
      .card.reveal{transform: translateY(0); opacity:1}
      .card h3{margin:0 0 10px; font-size:16px}
      .card .meta{font-size:12px; color:var(--muted)}

      footer{color:var(--muted); font-size:12px; padding:24px 0}
      footer .row{display:flex; justify-content:space-between}
    </style>
  </head>
  <body>
    <div class="bg"></div>
    <div class="glow" aria-hidden="true"></div>
    <div class="container">
      <nav>
        <div class="brand">ArxivCaster</div>
        <div><a href="podcast.xml">RSS</a></div>
      </nav>

      <section class="hero">
        <div class="eyebrow">Daily arXiv Podcast</div>
        <h1 class="title">最新の研究を、美しく毎日に。</h1>
        <p class="lead">厳選した arXiv の新着論文を日本語でわかりやすく。要約と台本を生成し、音声も自動で配信します。忙しい日々に、研究のインスピレーションを。</p>
        <div class="cta">
          <a id="cta-latest" class="btn" href="#">最新エピソードを聴く</a>
          <a class="btn secondary" href="podcast.xml">RSS を登録</a>
        </div>
      </section>

      <section class="latest" id="latest">
        <h3>最新エピソード</h3>
        <div class="meta" id="latest-meta">読み込み中...</div>
        <div id="latest-title" style="font-weight:600; margin-bottom:8px"></div>
        <audio id="latest-audio" controls style="width:100%"></audio>
        <div class="actions">
          <a id="latest-open" class="btn secondary" href="#">記事を読む</a>
        </div>
      </section>

      <div class="section">
        <h2>すべてのエピソード</h2>
        <div id="updated" class="meta"></div>
      </div>
      <div id="list" class="grid"></div>

      <footer>
        <div class="row">
          <div>© ArxivCaster</div>
          <div><a href="https://arxiv.org/" style="color:inherit">arXiv</a> / OpenAI</div>
        </div>
      </footer>
    </div>

    <script>
      async function loadIndex(){
        try{
          const res = await fetch('index.json');
          const data = await res.json();
          document.getElementById('updated').textContent = `最終更新: ${new Date(data.updatedAt).toLocaleString('ja-JP')}`;
          if(!data.items?.length){ return }
          // 最新
          const latest = data.items[0];
          const latestUrl = `viewer.html?slug=${encodeURIComponent(latest.slug)}`;
          document.getElementById('cta-latest').href = latestUrl;
          document.getElementById('latest-open').href = latestUrl;
          document.getElementById('latest-meta').textContent = `${new Date(latest.date).toLocaleString('ja-JP')}・${latest.slug}`;
          document.getElementById('latest-title').textContent = latest.title;
          document.getElementById('latest-audio').src = `episodes/${latest.slug}.mp3`;

          // 一覧
          const list = document.getElementById('list');
          list.innerHTML = '';
          const io = new IntersectionObserver((entries)=>{
            for(const e of entries){ if(e.isIntersecting){ e.target.classList.add('reveal'); io.unobserve(e.target) } }
          }, { rootMargin: '0px 0px -10% 0px' });
          for(const it of data.items){
            const a = document.createElement('a');
            a.className='card';
            a.href = `viewer.html?slug=${encodeURIComponent(it.slug)}`;
            a.innerHTML = `<h3>${escapeHtml(it.title)}</h3><div class="meta">${new Date(it.date).toLocaleString('ja-JP')}・${it.slug}</div>`;
            list.appendChild(a); io.observe(a);
          }
        }catch(e){ console.error(e); }
      }
      function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])) }
      loadIndex();
    </script>
  </body>
  </html>
